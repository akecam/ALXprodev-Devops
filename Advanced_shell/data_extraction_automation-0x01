#!/bin/bash

# Ensure the data.json file exists
if [ ! -f data.json ]; then
  echo "Error: data.json not found. Please run the API fetch script first."
  exit 1
fi

# Use jq to extract raw fields
raw_output=$(jq -r '
  .name,
  (.types[] | select(.slot == 1) | .type.name),
  .weight,
  .height
' data.json)

# Use awk to assign variables and convert units
readarray -t lines <<< "$raw_output"

name="${lines[0]}"
type="${lines[1]}"
weight="${lines[2]}"
height="${lines[3]}"

# Convert weight from decagrams to kg, height from decimeters to meters
formatted_weight=$(awk "BEGIN {printf \"%.1f\", $weight / 10}")
formatted_height=$(awk "BEGIN {printf \"%.1f\", $height / 10}")

# Capitalize name and type using sed
name=$(echo "$name" | sed -E 's/^(.)/\U\1/')
type=$(echo "$type" | sed -E 's/^(.)/\U\1/')

# Print formatted output
echo "$name is of type $type, weighs ${formatted_weight}kg, and is ${formatted_height}m tall."
